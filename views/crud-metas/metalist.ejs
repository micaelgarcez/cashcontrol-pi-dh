<%- include('../parts/head',{title:'CASH CONTROL - Metas'}); %>
<main>
    <div class="container-button">
		<a class="btn blue popup" href="">Copiar para MÃªs Seguinte</a>
	</div>

	<section class="container">
		<div id="list-metas">
			<div class="item head">
				<div class="datas">
                    <div class="name"><p>Categoria</p></div>
                    <div class="name"><p>Valor Previsto</p></div>
                </div>
                <div class="datas">
                    <div class="name"><p>Valor Gasto</p></div>
                    <div class="name"><p>(%) Gasto</p></div>
                </div>
                <div class="buttons">
					<a href="#metaEdit">
						<%- include('../../public/img/icons/edit.svg'); %>
					</a>
					<a href="#metaDelete">
						<%- include('../../public/img/icons/delete.svg'); %>
					</a>
				</div>
			</div>
			<% for(let categoria of categorias ) { %>
				<div class="item">
					<div class="datas">
                        <div class="name"><p><%= categoria.nome %></p></div>
                        <div class="name"><p><%= categoria.valorprevisto.toLocaleString('pt-br', { minimumFractionDigits: 2 , style: 'currency', currency: 'BRL' }) %></p></div>
                    </div>
                    <div class="datas">
                        <div class="name"><p><%= categoria.valorgasto.toLocaleString('pt-br', { minimumFractionDigits: 2 , style: 'currency', currency: 'BRL' }) %></p></div>
                        <div class="name"><p><%= categoria.percentualgasto %></p></div>
                    </div>
                    <%if(!categoria.meta_id) {%>
                        <div class="container-button">
							<a class="btn blue popup" href="#metaCreate" data-ano="<%= Periodo.Ano %>" data-mes="<%= Periodo.Mes %>" data-categoriaid="<%= categoria.id %>">Criar</a>
						</div>
                    <%}
                    else {
                    %>
                        <div class="buttons">
                            <a class="popup" href="#metaEdit" data-id="<%= categoria.meta_id %>" data-ano="<%= Periodo.Ano %>"
                                data-mes="<%= Periodo.Mes %>" data-valor="<%= categoria.valorprevisto %>" 
                                data-categoriaid="<%= categoria.id %>">
                                <%- include('../../public/img/icons/edit.svg'); %>
                            </a>
                            <a class="notification" href="#metaDelete" data-id="<%= categoria.meta_id %>">
                                <%- include('../../public/img/icons/delete.svg'); %>
                                <form class="cd-<%= categoria.meta_id %>" method="POST" action="/metas/<%= categoria.meta_id %>/delete?_method=DELETE">
                                    <button type="submit"><img src="/img/icons/interface.svg" alt="Icone de remover"></button>
                                </form>
                            </a>
                        </div>
                    <%}%>
				</div>
			<% } %>
		</div>
	</section>
</main>
<%- include('../parts/foot'); %>

